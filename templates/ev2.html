{% extends "base.html" %}

{% load i18n %}
{% load crispy_forms_tags %}
{% load static %}
{% load socialaccount %}
{% load widget_tweaks %}


{% block style %} 	
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css">
{% endblock %}
{% block head_links %} 

<title>Sign In</title>

{% endblock %}


{% block head_title %}{% trans "Sign In" %} {% endblock %}

{% block bodyclass %} login {% endblock %}

{% block pageheader %}
{% endblock %}

{% block outer %}

<div class="page-header header-filter" style="background-image: url('{% static 'img/bg7.jpg' %}'); background-size: cover; background-position: top center; height:auto;">
    <div class="container" style="margin-top:200px;margin-bottom:100px;"> 
      {% if messages %}
      <div style="margin-bottom: 30px;">
        {% for message in messages %}
          <div class="row" >
            
            <div class="col-lg-4 col-md-6 ml-auto mr-auto">
                  <div class="alert alert-info">
                      <div class="container">
                      <div class="alert-icon">
                          <i class="material-icons">info_outline</i>
                      </div>
                      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                          <span aria-hidden="true"><i class="material-icons">clear</i></span>
                      </button>
                      <b>{{ message }}</b>
                      </div>
                  </div>
            </div>
                  
          </div>
        {% endfor %}
      </div>
      {% endif %}

      <div class="row">
        <div class="col-lg-8 col-md-8 ml-auto mr-auto">
            <div class="card text-center">
                <div class="card-header card-header-rose">
                    {% if event.host %}
                    <h4>{{ event.type }} conducted by {{ event.host }}</h4>
                    {% else %}
                    <h4>{{ event.type }}</h4>
                    {% endif %}
                    <h2 class="title">{{ event.name }}</h2>
                    
                  <ul class="nav nav-tabs">
                    <li class="nav-item">
                      <a class="nav-link active" href="#" onclick="openTab(event, 'description')">Description</a>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="#" onclick="openTab(event, 'details')">Details</a>
                    </li>
                    {% if event.rulebook %}
                    <li class="nav-item">
                      <a class="nav-link" href="{{ event.rulebook.url }}" download="{{ event.name }}">Rulebook</a>
                    </li>
                    {% endif %}
                    {% if not user.is_superuser %}
                        {% if event.participation_type == 'team' %}
                            <li class="nav-item">
                                {% if event in user.events.all %}
                                <a class="nav-link" href="#">Already Registered</a>
                                {% else %}
                                <a class="nav-link" href="#" onclick="openTab(event, 'register')">Register</a>
                                {% endif %}
                            </li>
                        {% else %}
                            <li class="nav-item">
                                {% if event in user.events.all %}
                                <a class="nav-link" href="#">Already Registered</a>
                                {% else %}
                                <a class="nav-link" href="{% url 'register' event.pk %}">Register</a>
                                {% endif %}
                            </li>
                        {% endif %}
                    {% else %}
                    <li class="nav-item">
                        <a class="nav-link" href="{% get_media_prefix %}workbooks/{{ wbname }}" download="{{ wbname }}">Registered Users</a>
                    </li>
                    {% endif %}

                  </ul>
                </div>
                <div class="card-body" id="description">
                  <h4 class="card-title">Description</h4>
                  <p class="card-text">{{ event.description }}</p>
                  
                </div>
                <div class="card-body" id="details">
                    {% if event.prize %}
                    <h4 class="card-title">Prizes worth Rs. {{ event.prize }}</h4>
                    <p class="card-text">{{ event.prize }}</p>
                    {% endif %}
                    <h4 class="card-title">Event Type</h4>
                    <p class="card-text">
                        {% if event.participation_type == 'team' %}
                        Team Event (Team Size: {{ event.min_team_size }}-{{ event.max_team_size }})
                        {% else %}
                        Individual Event 
                        {% endif %} 
                    </p>
                    <h4 class="card-title">Date</h4>
                    <p class="card-text">{{ event.date }}</p>
                    {% if event.time %}
                    <h4 class="card-title">Time</h4>
                    <p class="card-text">{{ event.time }}</p>
                    {% endif %}
                    {% if event.venue %}
                    <h4 class="card-title">Venue</h4>
                    <p class="card-text">{{ event.venue }}</p>
                    {% endif %}
                    
                  </div>
                  <div class="card-body" id="register">
                    <p class="card-text">This is a team event ({{ event.min_team_size }} to {{ event.max_team_size }} members). Create or join a team:</p>
                    <a href="{% url 'create_team' event.pk %}" class="btn btn-primary">Create Team</a>
                    <a href="{% url 'join_team' %}" class="btn btn-primary">Join a Team</a>
                  </div>
                 
              </div>
        </div>
      </div>
    </div>

</div>




{% endblock %}

{% block scripts %} <script src="{% static 'js/tabs.js' %}"></script> {% endblock %}